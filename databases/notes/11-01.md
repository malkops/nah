## Базы данных

### Базы данных

**Базы данных (БД)** - это совокупность данных, организованных в соответствии с концептуальной структурой, описывающей характеристики этих данных и взаимоотношения между ними, которая поддерживает одну или более областей применения.

Можно выделить три ключевых момента, первых из которых является строгим:
- БД хранится и обрабатывается в вычислительной системе;
- Данные в БД логически структурированы;
- БД включает схему или метаданные, описывающие её структуру.

Основаня функция БД - это предоставление единого хранилища для всей информации, относящейся к определенной теме или предметной области.

### Архитекутурные модели

Архитектурные модели разделяют на три основных вида:
- централизованная;
- файл -- сервер;
- клиент -- сервер.

#### Централизованная модель

Система состоит из **центрального компьютера** и подключенных к нему **терминалов**. Вся обработка данных выполняется в рамках этого единственного компьютера. Пользовательские терминалы не обладают вычислительными мощностями и являются простым интерфейсом.

#### Файл -- сервер

Система состоит из **файлового сервера**, который содержит файлы, необходимые для работы приложений и самой БД. Фактически, файловый сервер используется просто как общий жесткий диск.

Пользовательские приложения и полные копии БД размещены и функционируют на отдельных рабочих станциях и обращаются к файловому серверу только по мере необхдоимости получения доступа к нужным им файлам.

Поскольку файловый сервер не воспринимает SQL, то СУБД должна запросить у файлового сервера файлы, необходимые для совершения запроса. Это усложняет управление, так как может быть можественный одновременный доступ к файлам.

#### Клиент -- сервер

Современная модель архитектуры, предполагает, что **СУБД находится на сервере** и только она имеет доступ к файлам БД.

На клиентских компьютерах работаю пользовательские приложения и клиентские компоненты СУБД, которые взаимодействую с сервером.

Таким образом **повышается производительность системы**, гарантируется **согласованность и целостность данных**.


### СУБД

**СУБД** - это программа, с помощью которой осуществляется хранение, обработкаЮ управление и поиск информации в БД. СУБД используется для выполнения различных операцийс данными:
- ввод, хранение, манипулирование
- выборка, поиск
- обработка запросов к БД
- защита данных от потери или несанкционированного доступа

СУБД можно разделить на следующие категории:
- Реляционные
- Объектно-ориентированные
- NoSQL
  - Иерархические
  - Сетевые
  - Графовые
  - Документо-ориентированные
  - Ключ-значение
  - Column-oriented

#### Релиционные СУБД

В данных СУБД отношения между данными являются реляционными и данные хрантся в виде таблиц. Каждый столбец таблицы представляет **атрибут**, а каждая строка траблицы представляет **запись**. Для взаимодействия с данными используется SQL.

#### Объектно-ориентированные СУБД

Предоставляют полнофункциональные возможности программирования БД, сохраняя при этом совместимость с ООП языками. Работа с такой СУБД осуществляется только посредством кода.

#### NoSQL СУБД

Базы данных **NoSQL** не используют SQL в качестве основного языка доступа к данным. NoSQL не имеет предопределенных схем, что делает её идеальным кандидатом для быстро меняющихся сред разработки. По сути изменения в таких СУБД можно осуществлять на лету.

#### NoSQL - Иерархические СУБД

В иерархической модели, данные организованы в **древовидную структуру**. Данные хранятся в виде **полей**, где каждое поле содержит только **одно значение**. Записи связаны между собой через отношение **родитель-потомок**. При этом родитель может иметь несколько потомков, а потомок только одного родителя.

#### NoSQL - Сетевые СУБД

**Сетевые СУБД** - используют сетевую (web) структуру отношений между объектами. Сетевая база данных похожа на "паутину". Данные хранятся аналогично иерархической модели - **поле содержит одно значение**, но каждый элеменет может иметь **связь с несколькими объектами**.

#### NoSQL - Графовые СУБД

Использует структуру **графов** для семантических запросов. Данные хранятся в виде **узлов, ребер и свойств**. **Узел** представляет собой объект, **ребро** - отношение, которые соединяет узлы, а **свойство** - дополнительная информация, добавляемая к узлам.

#### NoSQL - Документо-ориентированные СУБД

Данные хранятся в виде **документтов**. Каждый документ, представляет собой данные в виде "ключ-значение", связь с другими объектами и мета-поля.

#### NoSQL - Ключ-значение СУБД

БД на основе пар "ключ-значнеие" хранит данные как **совокупность пар** "ключ-значение", в которых ключ служит **уникальным идентификатором**. Как ключи, так и значения могут представлять собой **что угодно**: от простых до сложных составных объектов.

#### NoSQL - Column-oriented СУБД

В таких системах данные хранятся в виде матрицы, строки и столбцы которой используются как ключи. Каждая строка имеет свой набор столбцов. Примером применения этого типа СУБД является веб-индексирование, а также задачи, связанные с большими данными, с пониженными требованиями к согласованности. 

### Транзакции

**Транзакция** - это последовательность действий, объединенных в одну операцию **всё или ничего**. Промежуточные состояния внутри последовательности не видны другим транзакциям, и если что-то помешает звершить транзакцию, то ни один из результатов этих действий не будет записан в БД.

Транзакции должны удовлетворять требованиям **ACID**: атомарность (atomicity), согласованность (consistency), изоляция (isolation), долговечность (durability).

- **Атомарность** означает, что при фиксации выполняются все операции составляющие транзакцию, а при откате - не выполняется ни одна. 
- **Согласованность** - поддержание целостности данных. Транзакция начинает работу в согласованном (целостном) состоянии и по окончании своей работы также оставляет данные согласованными.
- **Изоляция** означает, что результат работы транзакции не влияет на другие, одновременно с ней выполняющиеся транзакции.
- **Долговечность** - подразумевает возможность восстановить базу данных поле сбоя в согласованном состоянии.

### CAP

Теорема **CAP** (теорема Брюера) - эвристическое утверждение о том, что в любой реализации распределенных вычислений возможно обеспечить не более двух из трёх следующих свойств:
- согласованность данных (consistency),
- доступность (availability),
- устойчивость к разделению (partition tolerance).

- **Согласованность данных** (consistency) - как только мы успешно записали данные в наше распределенное хранилище, любой клиент при запросе получит эти последние данные.
- **Доступность** (availability) - в любой момент клиент может получить данные из нашего хранилища или получить ответ об их отсутствии, если их никто еще не сохранял.
- **Устойчивость к разделению** (partition tolerance) - потеря сообщений между компонентами системы (возможно даже потеря всех сообщений) не влияет на работоспособность системы. Здесь очень важный момент: если какие-то компоненты выходят из строя, то это тоже подпадает под этот случай, так как можно считать, что данные компоненты просто теряют связь со всей остальной системой.

#### Классы систем

В системе класса **CA** во всех узлах данные согласованы, и обеспечена доступность, при этом она жертвует устойчивостью к распаду на секции.

Система класса **CP** в каждый момент обеспечивает целостный результат и способна функционировать в условиях распада, но достигает этого в ущерб доступности: может не выдавать отклик на запрос.

В системе класса **AP** не гарантируется целостность, но при этом выполнены условия доступности и устойчивости к распаду на секции.
