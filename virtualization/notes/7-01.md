## Ansible

### IAC
**Инфраструктура как код** - это подход к управлению и описанию инфраструктуры через конфигурационные файлы, а не через ручное редактирование конфигураций на серверах.

Плюсы IAC:
 - Нет необходимости в ручной настройке;
 - Скорость: настройка/поднятие инфраструктуры занимает на порядок меньше времени;
 - Воспроизводимость: поднимаемая инфраструктура всегда идентична;
 - Масштабируемость: один инженер может с помощью одного и того же кода настраивать и управлять большим парком машин.

### Configuration management systems

**Системы управления конфигурациями** - программы и комплексы, позволяющие централизованно управлять конфигурацией множества разнообразных разрозненных ОС и прикладного ПО, работающего в них. При работе с системами управления конфигурациями говорят об автоматизации инфраструктуры или об оркестрации серверов.

Преимущества Configuration management system:
 - Использовать систему контроля версий для отслеживания любых изменений инфраструктуры;
 - Повторно использовать скрипты конфигурирования для нескольких серверных сред (разработка, тестирование, прод);
 - Предоставлять сотрудникам общий доступ к скриптам конфигурирования для упрощения сотрудничества в стандартной среде разработки;
 - Упрощать процесс дублирования серверов для ускорения восстановления в случае сбоя системы.

Примеры инструментов управления кофигурацией:
 - **Chef** - DSL, Ruby, клиент-сервер;
 - **Puppet** - DSL (JSON), Ruby, клиент-сервер;
 - **SaltStack** - YAML, Python, клиент-сервер, безагентный;
 - **Ansible** - YAML, Python, безагентный.

### Ansible

**Ansible** - система управления конфигурациями, Позволяет централизованно управлять ПО, ОС и их настройками на Linux, Mac, Windows. Написан на Python, открытый исходный код, разработчик - Red Hat. Ansible отправляет команды на удаленные хосты через ssh.

Особенности Ansible:
 - **Безагентный** - для работы (настройки) с управляемым узлом нет необходимости ставить на управляемый узел агента. Необходимых требований только два: работающий ssh-сервер, python >= 2.6.
 - **Идемпотентность** - независимо от того, сколько раз вы будете запускать playbook, результат всегда должно приводить к одном и тому же состоянию.
 - **Push-model** - изменения конфигураций "заталкиваются" на управляемые узлы. Это может быть и минусом.

Терминология:
 - **Узел управления** - устройство с установленным и настроенным Ansible. Может быть ваш ноутбук или специальный узел в сети, выделенный для задач управления.
 - **Управляемые узлы** - узлы, конфигурация которых выполняется.
 - **Файлы инвентаризации (inventory)** - файл(ы), в которых перечислены управляемые узлы: *.ini, *.yaml или динамический конфигурируемым. Другими словами, это файл, в котором описываются устройства, к которым будет подключаться и управлять Ansible. Две группы по умолчанию (all и ungrouped).
 - **Модули (modules)** - инструментарий Ansible, отвечают за действия, которые выполняет Ansible. Это небольшие программы, входящие в поставку, принимающие на вход значения и выполняющие работу на целевых хостах. Фактически вся работа происходит с использованием модулей.
 - **Задачи (tasks)** - отдельный элемент работы, которую нужно выполнить. Могут выполняться самостоятельно или в составе плейбук.
 - **Плейбук (playbook)** - состоит из списка задач и/или других директив, указывающих на то, какие действия и где будут производиться.
 - **Обработчики (handlers)** - элемент, который служит для экономии кода и сособен перезапускать службу при его вызове.
 - **Роли (roles)** - набор плейбуков и других файлов, которые предназначены для выполнения какой-либо конечной задачи. Также упрощают, сокращают код и делают его переносимым.

Ansible.cfg - это основной конфигурационный файл. Может храниться:
 - ANSIBLE_CONFIG (ппеременная окрежения);
 - ansible.cfg (в текущем каталоге);
 - ~/.ansible.cfg (в домашнем каталоге пользователя);
 - /etc/ansible/ansible.cfg (можно брать за образец для внесения правок).

 - Упрощать процесс дублирования серверов для ускорения восстановления в случае сбоя системы.

Примеры инструментов управления кофигурацией:
 - **Chef** - DSL, Ruby, клиент-сервер;
 - **Puppet** - DSL (JSON), Ruby, клиент-сервер;
 - **SaltStack** - YAML, Python, клиент-сервер, безагентный;
 - **Ansible** - YAML, Python, безагентный.

### Ansible

**Ansible** - система управления конфигурациями, Позволяет централизованно управлять ПО, ОС и их настройками на Linux, Mac, Windows. Написан на Python, открытый исходный код, разработчик - Red Hat. Ansible отправляет команды на удаленные хосты через ssh.

Особенности Ansible:
 - **Безагентный** - для работы (настройки) с управляемым узлом нет необходимости ставить на управляемый узел агента. Необходимых требований только два: работающий ssh-сервер, python >= 2.6.
 - **Идемпотентность** - независимо от того, сколько раз вы будете запускать playbook, результат всегда должно приводить к одном и тому же состоянию.
 - **Push-model** - изменения конфигураций "заталкиваются" на управляемые узлы. Это может быть и минусом.

Терминология:
 - **Узел управления** - устройство с установленным и настроенным Ansible. Может быть ваш ноутбук или специальный узел в сети, выделенный для задач управления.
 - **Управляемые узлы** - узлы, конфигурация которых выполняется.
 - **Файлы инвентаризации (inventory)** - файл(ы), в которых перечислены управляемые узлы: *.ini, *.yaml или динамический конфигурируемым. Другими словами, это файл, в котором описываются устройства (IP или DNS), к которым будет подключаться и управлять Ansible. Две группы по умолчанию (all и ungrouped).
 - **Модули (modules)** - инструментарий Ansible, отвечают за действия, которые выполняет Ansible. Это небольшие программы, входящие в поставку, принимающие на вход значения и выполняющие работу на целевых хостах. Фактически вся работа происходит с использованием модулей.
 - **Задачи (tasks)** - отдельный элемент работы, которую нужно выполнить. Могут выполняться самостоятельно или в составе плейбук.
 - **Плейбук (playbook)** - состоит из списка задач и/или других директив, указывающих на то, какие действия и где будут производиться.
 - **Обработчики (handlers)** - элемент, который служит для экономии кода и сособен перезапускать службу при его вызове.
 - **Роли (roles)** - набор плейбуков и других файлов, которые предназначены для выполнения какой-либо конечной задачи. Также упрощают, сокращают код и делают его переносимым.

**ansible.cfg** - это основной конфигурационный файл. Может храниться:
 - ANSIBLE_CONFIG (ппеременная окрежения);
 - ansible.cfg (в текущем каталоге);
 - ~/.ansible.cfg (в домашнем каталоге пользователя);
 - /etc/ansible/ansible.cfg (можно брать за образец для внесения правок).
